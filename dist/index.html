<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>REWQ - swipe shortdut on your keyboard</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <p>Redirecting...</p>
    <p><strong>Help</strong></p>
    <p>To Change Settings - <a href="https://rewq.app/settings">rewq.app/settings</a></p>
    <script>
        var enabled = [];
        
        function setup() {
            var count = parseInt(localStorage.getItem('count') || 0);
            for (var idx = 0; idx < count; idx++) {
                var data = localStorage.getItem('row-' + idx);
                var record = data && JSON.parse(data);
                if (!record || !record.enabled) {
                    continue;
                }
                enabled.push(record);
            }
        }

        function redirect() {
            if (enabled.length === 0) {
                window.location.pathname = '/settings';
                return;
            }

            var destUrl = null;
            var mode = localStorage.getItem("mode") || 'list';

            if (mode === 'list') {
                window.location.pathname = '/list';
                return;
            }

            if (mode === 'random') {
                var idx = Math.floor(Math.random() * urls.length);
                destUrl = enabled[idx].url;
            } else if (mode === 'increment') {
                idx = parseInt(localStorage.getItem('lastIndex') || '-1');
                idx = (idx + 1) % urls.length;
                localStorage.setItem('lastIndex', idx);
                destUrl = enabled[idx].url;        
            }
            window.location.href = destUrl;
        }

        setup();
        redirect();
    </script>
</body>
</html>